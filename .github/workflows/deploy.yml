name: Deploy to GitHub Pages

on:
  push:
    branches: [ master ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    # PÅ™idÃ¡nÃ­ oprÃ¡vnÄ›nÃ­ pro zÃ¡pis do repozitÃ¡Å™e
    permissions:
      contents: write
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3
        with:
          persist-credentials: true # ZajistÃ­, Å¾e credentials budou dostupnÃ© pro dalÅ¡Ã­ kroky

      - name: Create config files ğŸ”§
        run: |
          # VytvoÅ™enÃ­ config.js z tajemstvÃ­
          echo "VytvÃ¡Å™Ã­m soubor config.js z tajemstvÃ­"
          echo "${{ secrets.CONFIG_JS }}" > config.js
          echo "Kontrola vytvoÅ™enÃ©ho souboru config.js:"
          ls -la config.js
          echo "PrvnÃ­ch 10 Å™Ã¡dkÅ¯ souboru (bez citlivÃ½ch ÃºdajÅ¯):"
          head -n 10 config.js | grep -v "API_KEY\|CLIENT_ID\|ALLOWED_EMAILS\|FOLDERS"

          # VytvoÅ™enÃ­ weather-config.js z tajemstvÃ­
          echo "VytvÃ¡Å™Ã­m soubor weather-config.js z tajemstvÃ­"
          echo "${{ secrets.WEATHER_CONFIG_JS }}" > weather-config.js
          echo "Kontrola vytvoÅ™enÃ©ho souboru weather-config.js:"
          ls -la weather-config.js
          echo "PrvnÃ­ch 10 Å™Ã¡dkÅ¯ souboru (bez citlivÃ½ch ÃºdajÅ¯):"
          head -n 10 weather-config.js | grep -v "API_KEY"

      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: . # SloÅ¾ka, kterÃ¡ bude nasazena
          branch: gh-pages # VÄ›tev, kam bude nasazeno
          clean: true # VyÄistÃ­ cÃ­lovou vÄ›tev pÅ™ed nasazenÃ­m
          single-commit: true # PouÅ¾ije jeden commit mÃ­sto historie
          token: ${{ github.token }} # PouÅ¾ije automaticky generovanÃ½ token pro pÅ™Ã­stup
